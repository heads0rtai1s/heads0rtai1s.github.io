<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.92.0" />


<title>R &amp; Python Rosetta Stone: Reading files and column transformations - head spin - the Heads or Tails blog</title>
<meta property="og:title" content="R &amp; Python Rosetta Stone: Reading files and column transformations - head spin - the Heads or Tails blog">


  <link href='https://heads0rtai1s.github.io/favicon.ico' rel='icon' type='image/x-icon'/>



  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/avatar.png"
         width="50"
         height="50"
         alt="Heads or Tails">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="/blogroll/">Blogroll</a></li>
    
    <li><a href="https://twitter.com/heads0rtai1s">Twitter</a></li>
    
    <li><a href="https://www.kaggle.com/headsortails">Kaggle</a></li>
    
    <li><a href="https://www.linkedin.com/in/martin-henze">LinkedIn</a></li>
    
    <li><a href="https://github.com/heads0rtai1s">GitHub</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">30 min read</span>
    

    <h1 class="article-title">R &amp; Python Rosetta Stone: Reading files and column transformations</h1>

    
    <span class="article-date">2022-02-24</span>
    

    <div class="article-content">
      
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>This post continues my series on translations between R and Python code for common data science and machine learning tasks. A documented cheat sheet for those such as myself, who frequently switch between the two languages for different tasks.</p>
<p>I had written the <a href="https://heads0rtai1s.github.io/2020/11/05/r-python-dplyr-pandas/">first post in this series back in late 2020</a>, full of optimism that it would kick off a whole series of frequent posts on the topic. Alas, other projects took precedence, as they often do. Now, I’m back with renewed elan to do more blogging this year, and write more posts on R &amp; Python.</p>
<p>Let’s get the setting out of the way: all code is reproducible in <a href="https://rmarkdown.rstudio.com/">Rmarkdown</a> via <a href="https://rstudio.com/">Rstudio IDE</a> (version 1.2 onwards). Python is integrated through <a href="https://rstudio.github.io/reticulate/">reticulate</a>; check out my <a href="https://heads0rtai1s.github.io/2019/10/03/reticulate-intro/">intro post on reticulate</a> to get started with that. Those are our R and Python libraries:</p>
<pre class="r"><code># R
libs &lt;- c(&#39;dplyr&#39;, &#39;stringr&#39;,     # wrangling
          &#39;palmerpenguins&#39;, &#39;gt&#39;, # data, table styling
          &#39;vroom&#39;, &#39;readr&#39;,       # read &amp; write data
          &#39;tidyr&#39;, &#39;purrr&#39;,       # wrangle &amp; iterate
          &#39;fs&#39;,                   # file system
          &#39;reticulate&#39;)           # python support 
invisible(lapply(libs, library, character.only = TRUE))

use_python(&quot;/usr/bin/python3&quot;)

df_orig &lt;- penguins %&gt;% 
  mutate_if(is.integer, as.double) %&gt;% 
  select(-contains(&quot;length&quot;), -contains(&quot;depth&quot;))</code></pre>
<pre class="python"><code># Python
import pandas as pd
import glob
pd.set_option(&#39;display.max_columns&#39;, None)</code></pre>
<p>Once again we will use the <a href="https://www.kaggle.com/parulpandey/palmer-archipelago-antarctica-penguin-data">Palmer Penguins dataset</a> from the <a href="https://allisonhorst.github.io/palmerpenguins/">eponymous R package</a>. I will use a smaller subset of columns for reasons of readability.</p>
<p>This dataset contains measurements and characteristics for 3 species of penguin, namely:</p>
<pre class="r"><code>df_orig %&gt;% 
  count(species) %&gt;% 
  gt()</code></pre>
<div id="jntjloagzj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jntjloagzj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jntjloagzj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jntjloagzj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jntjloagzj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jntjloagzj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jntjloagzj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jntjloagzj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jntjloagzj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jntjloagzj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jntjloagzj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jntjloagzj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jntjloagzj .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jntjloagzj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jntjloagzj .gt_from_md > :first-child {
  margin-top: 0;
}

#jntjloagzj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jntjloagzj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jntjloagzj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#jntjloagzj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jntjloagzj .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#jntjloagzj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jntjloagzj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jntjloagzj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jntjloagzj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jntjloagzj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jntjloagzj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#jntjloagzj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jntjloagzj .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#jntjloagzj .gt_left {
  text-align: left;
}

#jntjloagzj .gt_center {
  text-align: center;
}

#jntjloagzj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jntjloagzj .gt_font_normal {
  font-weight: normal;
}

#jntjloagzj .gt_font_bold {
  font-weight: bold;
}

#jntjloagzj .gt_font_italic {
  font-style: italic;
}

#jntjloagzj .gt_super {
  font-size: 65%;
}

#jntjloagzj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">species</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_center">Adelie</td>
<td class="gt_row gt_right">152</td></tr>
    <tr><td class="gt_row gt_center">Chinstrap</td>
<td class="gt_row gt_right">68</td></tr>
    <tr><td class="gt_row gt_center">Gentoo</td>
<td class="gt_row gt_right">124</td></tr>
  </tbody>
  
  
</table>
</div>
<p>In this exercise we will take the data frame apart into different files by species, and then put it back together again.</p>
<div id="briefly-writing-multiple-csv-files" class="section level3">
<h3>Briefly: Writing multiple csv files</h3>
<p>The breaking-apart bit is not the focus of this post, though. I’m borrowing it from <a href="https://stackoverflow.com/questions/46620208/write-multiple-csv-files-by-group">this stackoverflow post</a>. To make the rest of this exercise more compact, we will only write out 1 row per species to a csv file:</p>
<pre class="r"><code># R
df_orig %&gt;%
  group_by(species) %&gt;% 
  slice_head(n = 1) %&gt;% 
  ungroup() %&gt;% 
  nest(data = c(-species)) %&gt;% 
  pwalk(function(species, data) write_csv(data, file.path(&quot;.&quot;, str_c(species, &quot;_penguins.csv&quot;))))</code></pre>
<p>For reasons of brevity this code chunk will remain somewhat of black box; otherwise this post would balloon into something much longer. See it as a sneak peak for future content; and also something you can just use as is or explore for yourself.</p>
<p>Some brief notes only: <code>slice_head</code> is a new addition to the <code>dplyr</code> package - an evolution of the previous <code>slice</code> - and it does pretty much what you would expect: slicing off the first n entries (here by group). In <code>nest</code> we have a <code>tidyr</code> tool that bundles together the select columns into a list column (here everything except <code>species</code>). Finally, the <code>purrr</code> package function <code>pwalk</code> iterates over a list, here writing out the different parts of the dataframe with custom names.</p>
<p>As it stands, <code>purrr</code> remains one of my weak points in the tidyverse and I plan to revisit it in a future post. For now, onward with the meat of this episode.</p>
</div>
<div id="reading-a-single-csv-file" class="section level3">
<h3>Reading a single csv file</h3>
<p>In R, the standard tool for reading csv files is <code>readr::read_csv</code>. However, I prefer the <code>vroom</code> function from the <a href="https://vroom.r-lib.org/">vroom package</a>. Like its onomatopoeic name suggests, this package is fast. Faster than <code>data.table::fread</code>, which I had preferred until <code>vroom</code> came around.</p>
<p>In the Python / pandas world, options are more limited and we use <code>pd.read_csv</code>:</p>
<pre class="r"><code># R

single_file &lt;- vroom(&quot;Adelie_penguins.csv&quot;, col_types = cols())

single_file %&gt;% 
  gt()</code></pre>
<div id="eqrbefprfx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#eqrbefprfx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eqrbefprfx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eqrbefprfx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eqrbefprfx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eqrbefprfx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eqrbefprfx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eqrbefprfx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eqrbefprfx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eqrbefprfx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eqrbefprfx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eqrbefprfx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eqrbefprfx .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#eqrbefprfx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eqrbefprfx .gt_from_md > :first-child {
  margin-top: 0;
}

#eqrbefprfx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eqrbefprfx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eqrbefprfx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#eqrbefprfx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eqrbefprfx .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#eqrbefprfx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eqrbefprfx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eqrbefprfx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eqrbefprfx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eqrbefprfx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eqrbefprfx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#eqrbefprfx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eqrbefprfx .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#eqrbefprfx .gt_left {
  text-align: left;
}

#eqrbefprfx .gt_center {
  text-align: center;
}

#eqrbefprfx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eqrbefprfx .gt_font_normal {
  font-weight: normal;
}

#eqrbefprfx .gt_font_bold {
  font-weight: bold;
}

#eqrbefprfx .gt_font_italic {
  font-style: italic;
}

#eqrbefprfx .gt_super {
  font-size: 65%;
}

#eqrbefprfx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">island</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">body_mass_g</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">year</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Torgersen</td>
<td class="gt_row gt_right">3750</td>
<td class="gt_row gt_left">male</td>
<td class="gt_row gt_right">2007</td></tr>
  </tbody>
  
  
</table>
</div>
<pre class="python"><code># Python

single_file = pd.read_csv(&quot;Adelie_penguins.csv&quot;)

single_file</code></pre>
<pre><code>##       island  body_mass_g   sex  year
## 0  Torgersen         3750  male  2007</code></pre>
<p>Other than pandas adding its characteristic index, we get the same data frame as the result. So far, so straight-forward.</p>
</div>
<div id="reading-multiple-csv-files" class="section level3">
<h3>Reading multiple csv files</h3>
<p>But what I really want to write about here is the reading of multiple csv files. Those approaches will be very convenient if you’re in a situation where you have a directory that contains many csv files with the same schema (perhaps from an automated daily pipeline).</p>
<p>Before we can read those files, we first have to find them. In R, we use the <code>dir_ls</code> tool from the <code>fs</code> package to search in the current directory (<code>.</code>) for a global pattern (<code>"*penguins.csv"</code>):</p>
<pre class="r"><code># R
(files &lt;- fs::dir_ls(&quot;.&quot;, glob = &quot;*penguins.csv&quot;))</code></pre>
<pre><code>## Adelie_penguins.csv    Chinstrap_penguins.csv Gentoo_penguins.csv</code></pre>
<p>Which gives us the 3 files that we had split our penguin data into. Now we can feed that vector of files directly into <code>vroom</code> (or <code>read_csv</code>):</p>
<pre class="r"><code># R
df &lt;- vroom(files, col_types = cols(), id = &quot;name&quot;)

df %&gt;% 
  gt()</code></pre>
<div id="ezcngxbutp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ezcngxbutp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ezcngxbutp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ezcngxbutp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ezcngxbutp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ezcngxbutp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ezcngxbutp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ezcngxbutp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ezcngxbutp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ezcngxbutp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ezcngxbutp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ezcngxbutp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ezcngxbutp .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ezcngxbutp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ezcngxbutp .gt_from_md > :first-child {
  margin-top: 0;
}

#ezcngxbutp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ezcngxbutp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ezcngxbutp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ezcngxbutp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ezcngxbutp .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ezcngxbutp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ezcngxbutp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ezcngxbutp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ezcngxbutp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ezcngxbutp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ezcngxbutp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ezcngxbutp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ezcngxbutp .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ezcngxbutp .gt_left {
  text-align: left;
}

#ezcngxbutp .gt_center {
  text-align: center;
}

#ezcngxbutp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ezcngxbutp .gt_font_normal {
  font-weight: normal;
}

#ezcngxbutp .gt_font_bold {
  font-weight: bold;
}

#ezcngxbutp .gt_font_italic {
  font-style: italic;
}

#ezcngxbutp .gt_super {
  font-size: 65%;
}

#ezcngxbutp .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">island</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">body_mass_g</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">year</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Adelie_penguins.csv</td>
<td class="gt_row gt_left">Torgersen</td>
<td class="gt_row gt_right">3750</td>
<td class="gt_row gt_left">male</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Chinstrap_penguins.csv</td>
<td class="gt_row gt_left">Dream</td>
<td class="gt_row gt_right">3500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Gentoo_penguins.csv</td>
<td class="gt_row gt_left">Biscoe</td>
<td class="gt_row gt_right">4500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
  </tbody>
  
  
</table>
</div>
<p>As you can see, the <code>id</code> parameter here allows us to add the nifty <code>name</code> column, which holds the file name. Since we had named our files after the species of penguin, this allows us to get that species information back in our table. Other applications would be to have file names that carry time stamps or other information about your upstream pipeline. If you have control over the naming schema of that pipeline output, or can bribe someone who has, then you can probably make your life quite a bit easier by including useful information in those file names</p>
<p>In Python, we use <code>glob</code> to grab the file names:</p>
<pre class="python"><code>files_py = glob.glob(&quot;*penguins.csv&quot;)
files_py</code></pre>
<pre><code>## [&#39;Adelie_penguins.csv&#39;, &#39;Chinstrap_penguins.csv&#39;, &#39;Gentoo_penguins.csv&#39;]</code></pre>
<p>And then read like this. What <code>pd.concat</code> does it is binds together a list of data frames into a single data frame. That list comes from one of Python’s favourite approaches: the <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">list comprehension</a>. There’s much to say about the flexibility and elegance of list comprehensions, but when it comes down to it they’re basically a for loop in a single line that outputs a list. So here we loop through the 3 file names and read them into a list of data frames to feed to <code>pd.concat</code>.</p>
<pre class="python"><code>df_py = pd.concat((pd.read_csv(f) for f in files_py))
df_py</code></pre>
<pre><code>##       island  body_mass_g     sex  year
## 0  Torgersen         3750    male  2007
## 0      Dream         3500  female  2007
## 0     Biscoe         4500  female  2007</code></pre>
<p>But that is still missing the file name. Luckily, we can get that information through the nifty <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.assign.html">assign function</a>:</p>
<pre class="python"><code>df_py = pd.concat((pd.read_csv(f).assign(name = f) for f in files_py))
df_py</code></pre>
<pre><code>##       island  body_mass_g     sex  year                    name
## 0  Torgersen         3750    male  2007     Adelie_penguins.csv
## 0      Dream         3500  female  2007  Chinstrap_penguins.csv
## 0     Biscoe         4500  female  2007     Gentoo_penguins.csv</code></pre>
<p>Great! Now we got the information that is contained in the file name conveniently in our data frame.</p>
<p>Like I wrote earlier, in the wild it can often happen that file names contain vital information. Sometimes so much so, that we want to parse this feature out further.</p>
</div>
<div id="separating-1-column-into-multiple" class="section level3">
<h3>Separating 1 column into multiple</h3>
<p>In R, for turning one column into multiple we have the <code>separate</code> function from the <code>tidyr</code> package. You give it the names that you want to assign to the new columns, along with the separator. (Note, that here we need to escape the dot so that it doesn’t get misinterpreted as a regular expression).</p>
<pre class="r"><code>df %&gt;% 
  separate(name, into = c(&quot;name&quot;, &quot;filetype&quot;), sep = &quot;\\.&quot;) %&gt;% 
  gt()</code></pre>
<div id="pzmxfwbgme" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pzmxfwbgme .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pzmxfwbgme .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzmxfwbgme .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pzmxfwbgme .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pzmxfwbgme .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzmxfwbgme .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzmxfwbgme .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pzmxfwbgme .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pzmxfwbgme .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pzmxfwbgme .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pzmxfwbgme .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pzmxfwbgme .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pzmxfwbgme .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pzmxfwbgme .gt_from_md > :first-child {
  margin-top: 0;
}

#pzmxfwbgme .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pzmxfwbgme .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pzmxfwbgme .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pzmxfwbgme .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzmxfwbgme .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pzmxfwbgme .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzmxfwbgme .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pzmxfwbgme .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pzmxfwbgme .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzmxfwbgme .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzmxfwbgme .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pzmxfwbgme .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzmxfwbgme .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pzmxfwbgme .gt_left {
  text-align: left;
}

#pzmxfwbgme .gt_center {
  text-align: center;
}

#pzmxfwbgme .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pzmxfwbgme .gt_font_normal {
  font-weight: normal;
}

#pzmxfwbgme .gt_font_bold {
  font-weight: bold;
}

#pzmxfwbgme .gt_font_italic {
  font-style: italic;
}

#pzmxfwbgme .gt_super {
  font-size: 65%;
}

#pzmxfwbgme .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">filetype</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">island</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">body_mass_g</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">year</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Adelie_penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Torgersen</td>
<td class="gt_row gt_right">3750</td>
<td class="gt_row gt_left">male</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Chinstrap_penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Dream</td>
<td class="gt_row gt_right">3500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Gentoo_penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Biscoe</td>
<td class="gt_row gt_right">4500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
  </tbody>
  
  
</table>
</div>
<p>And then of course we can further take apart the <code>name</code> column in the same way:</p>
<pre class="r"><code>df %&gt;% 
  separate(name, into = c(&quot;name&quot;, &quot;filetype&quot;), sep = &quot;\\.&quot;) %&gt;% 
  separate(name, into = c(&quot;species&quot;, &quot;animal&quot;), sep = &quot;_&quot;) %&gt;% 
  gt()</code></pre>
<div id="gxjbrgujgq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gxjbrgujgq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gxjbrgujgq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gxjbrgujgq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gxjbrgujgq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gxjbrgujgq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxjbrgujgq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gxjbrgujgq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gxjbrgujgq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gxjbrgujgq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gxjbrgujgq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gxjbrgujgq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gxjbrgujgq .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#gxjbrgujgq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gxjbrgujgq .gt_from_md > :first-child {
  margin-top: 0;
}

#gxjbrgujgq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gxjbrgujgq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gxjbrgujgq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#gxjbrgujgq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxjbrgujgq .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#gxjbrgujgq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxjbrgujgq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gxjbrgujgq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gxjbrgujgq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxjbrgujgq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gxjbrgujgq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#gxjbrgujgq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gxjbrgujgq .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#gxjbrgujgq .gt_left {
  text-align: left;
}

#gxjbrgujgq .gt_center {
  text-align: center;
}

#gxjbrgujgq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gxjbrgujgq .gt_font_normal {
  font-weight: normal;
}

#gxjbrgujgq .gt_font_bold {
  font-weight: bold;
}

#gxjbrgujgq .gt_font_italic {
  font-style: italic;
}

#gxjbrgujgq .gt_super {
  font-size: 65%;
}

#gxjbrgujgq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">species</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">animal</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">filetype</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">island</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">body_mass_g</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">year</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Adelie</td>
<td class="gt_row gt_left">penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Torgersen</td>
<td class="gt_row gt_right">3750</td>
<td class="gt_row gt_left">male</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Chinstrap</td>
<td class="gt_row gt_left">penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Dream</td>
<td class="gt_row gt_right">3500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Gentoo</td>
<td class="gt_row gt_left">penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Biscoe</td>
<td class="gt_row gt_right">4500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
  </tbody>
  
  
</table>
</div>
<p>In Python, pandas has no dedicated operation for splitting columns. Instead, this can be accomplished by using string functions, of which Python has a comparable set to R. For pandas data frames, we need to first add the <code>.str</code> method to indicate that a string operation follows, which will then be vectorised to the entire column. Here, we use two <code>split</code> calls on the same delimiters as above. The <code>expand</code> parameter takes care of the separation into multiple columns (otherwise the result would be a single column containing a list feature). Afterwards, we need to <code>drop</code> the <code>name</code> column to get the same result as for the R operations.</p>
<pre class="python"><code># Python
df_py = pd.concat((pd.read_csv(f).assign(name = f) for f in files_py))
df_py[[&#39;name&#39;, &#39;filetype&#39;]] = df_py[&#39;name&#39;].str.split(&#39;.&#39;, expand=True)
df_py[[&#39;species&#39;, &#39;animal&#39;]] = df_py[&#39;name&#39;].str.split(&#39;_&#39;, expand=True)
df_py = df_py.drop(&#39;name&#39;, axis = &#39;columns&#39;)

df_py</code></pre>
<pre><code>##       island  body_mass_g     sex  year filetype    species    animal
## 0  Torgersen         3750    male  2007      csv     Adelie  penguins
## 0      Dream         3500  female  2007      csv  Chinstrap  penguins
## 0     Biscoe         4500  female  2007      csv     Gentoo  penguins</code></pre>
<p>Note, that in contrast to R’s <code>separate</code> this process requires intermediate steps and cannot be chained.</p>
</div>
<div id="uniting-multiple-columns-into-a-single-one" class="section level3">
<h3>Uniting multiple columns into a single one</h3>
<p>As you can guess from my leading headers, I prefer the way that the tidyverse handles those operations. In order to join back together what had been put asunder, we use the <code>tidyr</code> function <code>unite</code>. We start from the separated version:</p>
<pre class="r"><code>df %&gt;% 
  separate(name, into = c(&quot;name&quot;, &quot;filetype&quot;), sep = &quot;\\.&quot;) %&gt;% 
  separate(name, into = c(&quot;species&quot;, &quot;animal&quot;), sep = &quot;_&quot;) %&gt;% 
  gt()</code></pre>
<div id="prkswusdjs" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#prkswusdjs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#prkswusdjs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prkswusdjs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#prkswusdjs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#prkswusdjs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prkswusdjs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prkswusdjs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#prkswusdjs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#prkswusdjs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#prkswusdjs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#prkswusdjs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#prkswusdjs .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#prkswusdjs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#prkswusdjs .gt_from_md > :first-child {
  margin-top: 0;
}

#prkswusdjs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#prkswusdjs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#prkswusdjs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#prkswusdjs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prkswusdjs .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#prkswusdjs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prkswusdjs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#prkswusdjs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#prkswusdjs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prkswusdjs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prkswusdjs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#prkswusdjs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prkswusdjs .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#prkswusdjs .gt_left {
  text-align: left;
}

#prkswusdjs .gt_center {
  text-align: center;
}

#prkswusdjs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#prkswusdjs .gt_font_normal {
  font-weight: normal;
}

#prkswusdjs .gt_font_bold {
  font-weight: bold;
}

#prkswusdjs .gt_font_italic {
  font-style: italic;
}

#prkswusdjs .gt_super {
  font-size: 65%;
}

#prkswusdjs .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">species</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">animal</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">filetype</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">island</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">body_mass_g</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">year</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Adelie</td>
<td class="gt_row gt_left">penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Torgersen</td>
<td class="gt_row gt_right">3750</td>
<td class="gt_row gt_left">male</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Chinstrap</td>
<td class="gt_row gt_left">penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Dream</td>
<td class="gt_row gt_right">3500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Gentoo</td>
<td class="gt_row gt_left">penguins</td>
<td class="gt_row gt_left">csv</td>
<td class="gt_row gt_left">Biscoe</td>
<td class="gt_row gt_right">4500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
  </tbody>
  
  
</table>
</div>
<p>And then go full circle and put it back together in the same breath. The 2 separating steps are being followed by two uniting steps that reverse them. For <code>unite</code>, you need to specify the columns that you want to paste together, then the name of the new column, and the delimiter character(s) to use.</p>
<pre class="r"><code>df %&gt;% 
  separate(name, into = c(&quot;name&quot;, &quot;filetype&quot;), sep = &quot;\\.&quot;) %&gt;% 
  separate(name, into = c(&quot;species&quot;, &quot;animal&quot;), sep = &quot;_&quot;) %&gt;% 
  unite(species, animal, col = &quot;name&quot;, sep = &quot;_&quot;) %&gt;% 
  unite(name, filetype, col = &quot;name&quot;, sep = &quot;.&quot;) %&gt;% 
  gt()</code></pre>
<div id="artovwolpf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#artovwolpf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#artovwolpf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#artovwolpf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#artovwolpf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#artovwolpf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#artovwolpf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#artovwolpf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#artovwolpf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#artovwolpf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#artovwolpf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#artovwolpf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#artovwolpf .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#artovwolpf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#artovwolpf .gt_from_md > :first-child {
  margin-top: 0;
}

#artovwolpf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#artovwolpf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#artovwolpf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#artovwolpf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#artovwolpf .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#artovwolpf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#artovwolpf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#artovwolpf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#artovwolpf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#artovwolpf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#artovwolpf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#artovwolpf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#artovwolpf .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#artovwolpf .gt_left {
  text-align: left;
}

#artovwolpf .gt_center {
  text-align: center;
}

#artovwolpf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#artovwolpf .gt_font_normal {
  font-weight: normal;
}

#artovwolpf .gt_font_bold {
  font-weight: bold;
}

#artovwolpf .gt_font_italic {
  font-style: italic;
}

#artovwolpf .gt_super {
  font-size: 65%;
}

#artovwolpf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">island</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">body_mass_g</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">year</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Adelie_penguins.csv</td>
<td class="gt_row gt_left">Torgersen</td>
<td class="gt_row gt_right">3750</td>
<td class="gt_row gt_left">male</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Chinstrap_penguins.csv</td>
<td class="gt_row gt_left">Dream</td>
<td class="gt_row gt_right">3500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
    <tr><td class="gt_row gt_left">Gentoo_penguins.csv</td>
<td class="gt_row gt_left">Biscoe</td>
<td class="gt_row gt_right">4500</td>
<td class="gt_row gt_left">female</td>
<td class="gt_row gt_right">2007</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Here, during the uniting the extra columns are being automatically dropped (i.e. <code>species</code>, <code>animal</code>, <code>filetype</code>), but you can change that behaviour by specifying <code>remove = FALSE</code>. The same applies to <code>separate</code>.</p>
<p>The pandas table is already separated, which was the hard part. Combining them is much more intuitive; making use of Python’s style to enable simple operations on complex objects. Strings can be concatenated using the <code>+</code> operator and constants get automatically expanded to vector dimensions. Thus you can treat those columns the same way as you would zero-dimensional variables.</p>
<p>The we remove the extra columns again, and voila: we’re back to where we started. Which, in this case, is a good thing:</p>
<pre class="python"><code>df_py[&#39;name&#39;] = df_py[&#39;species&#39;] + &quot;_&quot; + df_py[&#39;animal&#39;] + &quot;.&quot; + df_py[&#39;filetype&#39;]
df_py = df_py.drop([&#39;species&#39;, &#39;animal&#39;, &#39;filetype&#39;], axis = &#39;columns&#39;)

df_py</code></pre>
<pre><code>##       island  body_mass_g     sex  year                    name
## 0  Torgersen         3750    male  2007     Adelie_penguins.csv
## 0      Dream         3500  female  2007  Chinstrap_penguins.csv
## 0     Biscoe         4500  female  2007     Gentoo_penguins.csv</code></pre>
<hr />
<p>And this is it for today. To recap: we had a look at how to load a single csv file, then multiple csv files with R and Python. Then we used those data frames to practice separating and uniting of columns.</p>
<p>We thus added some rather import bread-and-butter tools of data analysis to our bilingual repertoire. (See what I did there?) More Rosetta Stone content to come soon.</p>
</div>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//headsortails.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-137904077-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  </body>
</html>

